<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">

    <title>Modes of Operation &middot; warrick.io</title>

    <link rel="stylesheet" href="//warrick.io/css/jane.css">
    <link rel="stylesheet" href="//warrick.io/css/syntax.css">
    <link rel="stylesheet" href="//warrick.io/css/font-awesome.css">


    <link href="" rel="alternate" type="application/rss+xml" title="warrick.io" />
  </head>
  <body>
    
  <h1>Modes of Operation</h1>
  <span class="post-date">Thu, Dec 8, 2011</span>
    <p>Knowing which encryption algorithm was used is one thing, but knowing how they
used it is another.</p>

<p>Here are 5 of the 9 NIST approved block cipher <em>modes of operation</em>:</p>

<p><strong>Electronic Codebook (ECB)</strong></p>

<p>Simplest of encryption modes.<br />
Encrypts each block Bi independently.</p>

<pre>
    Encryption:

    **C<sub>i</sub> = E<sub>k</sub>(B<sub>i</sub>)**

    C<sub>i</sub>: ciphertext block i
    E<sub>k</sub>: block encryption algorithm
    B<sub>i</sub>: plaintext block i

    Decryption:

    **B<sub>i</sub> = D<sub>k</sub>(C<sub>i</sub>)**

    D<sub>k</sub>: decryption algorithm

</pre>

<p><strong>Cipher-Block Chaining Mode (CBC)</strong></p>

<p>Avoids patterns.<br />
First plaintext block is xor&rsquo;d with an <em>initialization vector</em>.<br />
Each block thereafter is xor&rsquo;d with the previous ciphertext block before being encrypted.</p>

<pre>
    Encryption:

    **C<sub>i</sub> = E<sub>k</sub>(B<sub>i</sub> xor C<sub>i-1</sub>)**

    C<sub>0</sub>: initialization vector
 
    Decryption:

    **B<sub>i</sub> = D<sub>k</sub>(C<sub>i</sub>) xor C<sub>i-1</sub>**
    
    C<sub>0</sub>: must be the _same_ initialization vector

</pre>

<p><strong>Cipher Feedback Mode (CFB)</strong></p>

<p>Similiar to CBC, B<sub>i</sub> involves C<sub>i-1</sub>.<br />
May be faster than CBC depending on block cipher.</p>

<pre>
    Encryption:

    **C<sub>i</sub> = E<sub>k</sub>(C<sub>i-1</sub>) xor B<sub>i</sub>**
 
    Decryption:

    **B<sub>i</sub> = E<sub>k</sub>(C<sub>i - 1</sub>) xor C<sub>i</sub>**

</pre>

<p><strong>Output Feedback Mode (OFB)</strong></p>

<p>Generates sequence of vectors V, where V<sub>0</sub> is the initialization vector.<br />
Block operations can be performed in parallel after vectors are are computed.</p>

<pre>
    Vectors:

    **V<sub>i</sub>: E<sub>k</sub>(V<sub>i-1</sub>)**

    Encryption:

    **C<sub>i</sub> = V<sub>i</sub> xor B<sub>i</sub>**
 
    Decryption:

    **B<sub>i</sub> = V<sub>i</sub> xor C<sub>i</sub>**

</pre>

<p><strong>Counter Mode (CTR)</strong></p>

<p>Vector generation and encryption or decryption can all be done in parallel.<br />
Start with a random seed, s, and compute offset vectors independently.</p>

<pre>
    Vectors:

    **V<sub>i</sub>: E<sub>k</sub>(s + i - 1)**

    s: random seed

    Encryption:

    **C<sub>i</sub> = V<sub>i</sub> xor B<sub>i</sub>**
 
    Decryption:

    **B<sub>i</sub> = V<sub>i</sub> xor C<sub>i</sub>**

</pre>

<p><a href="http://csrc.nist.gov/groups/ST/toolkit/BCM/index.html">http://csrc.nist.gov/groups/ST/toolkit/BCM/index.html</a>
<a href="http://en.wikipedia.org/wiki/Block_cipher_modes_of_operation">http://en.wikipedia.org/wiki/Block_cipher_modes_of_operation</a></p>

  </div>

  </body>
</html>
